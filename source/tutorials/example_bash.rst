Example BASH Scripts for Common Tasks
=====================================

AaronTools command line scripts (CLSs) make it simple to write BASH scripts to automate many routine tasks.
A few examples are provided here to get you started!
More examples will be added over time to make this a sort of 'cookbook' of AaronTools BASH scripts.

Optimization and Frequencies
----------------------------

Perhaps the most common task in routine quantum chemistry applications is optimizing geometries for a set of molecules and computing vibrational frequencies.
This can be done simply using AaronTools CLSs using any quantum chemistry software package.
Here we use Gaussian as an example, but trivial changes to the scripts below would instead use Q-Chem, ORCA, or Psi4.

For instance, suppose we have a set of XYZ files containing initial geomtries that we would like to optimize.
These geometries could be for a set of molecules from some other sort or a set of conformations of a single molecule generated by CREST, for example.
The following script will run wB97XD/def2TZVP optimizations and frequencies on all XYZ files in the current directory:

.. literalinclude:: bash/opt_all
   :language: bash


If these XYZ files were different conformations of the same molecule, we could then identify the unique ones using :code:`unique.py`.

If initial XYZ files are not available, we can instead build all molecules from a list of IUPAC names and perform optimization + frequency computations.
For instance, suppose we have a file :code:`molecules` that contains a list of IUPAC names:

.. literalinclude:: bash/opt_all_iupac
   :language: bash

(Note that the above could be a little problematic if the IUPAC names include spaces, so it would be prudent to modify this to replace spaces in :code:`$mol` with "_", for example.)

Checking and Rerunning Jobs
---------------------------

After running the above optimizaitons, it is necessary to check two things:


#. Did the computations all finish correctly?
#. Are all optimized structures energy minima (no imaginary frequencies)

The following script will check these.
For jobs that did not generate an output file, the script just resubmits the original input file.
For jobs that ran but did not finish, a new job is submitted using the last geometry from the previous attempt using the same level of theory used in the corresponding output file.
For optimizations that ended with one or more imaginary vibrational frequencies, we displace along the vibrational mode using :code:`follow.py` and re-optimize.
We'll assume that we are working with a set of XYZ files, as in the first example above.
The modifications to instead use a list of IUPAC names should be obvious.
Changing the level of theory and/or quantum chemistry package should also be straightforward.

.. literalinclude:: bash/check_jobs
   :language: bash


Potential Energy Scans for Stacked Dimers
-----------------------------------------

AaronTools CLSs make it trivial to run scans over different coordinates for non-bonded dimers.
For instance, the script below will run wB97X-D/def2-TZVP single point energies on the benzene dimer as a function of x- and z-coordinates (with a fixed monomer geometry) from x = 0 - 3 angstroms and z = 3 - 4 angstroms.
It assumes that there is a local file called `benzene.xyz` that contains the coordinates of benzene in the xy-plane that is oriented with a vertex along the x-axis.

.. literalinclude:: bash/dimer_scan
   :language: bash

Note that :code:`combineMonomers.py` can only accept geometries from STDIN or from a list of files, so we save the shifted benzene geometry to `temp.xyz` before combining with `benzene.xyz` to build each dimer.

We could modify this to instead run the T-shaped benzene dimer by first rotating the second benzene (e.g. :code:`rotate.py benzene.xyz -x y -a 90`) and then piping this into :code:`translate.py`.

Note that :code:`makeInput.py` is not currently able to make SAPT input files, so if we wanted to run SAPT on these dimers we would need to use the AaronTools Python API to make and run these types of computations.

